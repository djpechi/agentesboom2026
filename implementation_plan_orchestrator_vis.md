# Implementation Plan - Deliverables Navigation & Orchestrator Visibility

This plan addresses the user's request for better navigation within the Deliverables view and visual confirmation of data handover to the Orchestrator Agent upon stage completion.

## User Objectives
1.  **Deliverables Navigation**: Add buttons to "Return to Chat" and "Continue to Next Stage" within the `Stage1Output` component.
2.  **Orchestrator Visibility**:
    *   Display a confirmation that data has been sent to the Orchestrator.
    *   Show which variables/data points are being passed to the next stage.
    *   Ensure the visual feedback clarifies that the Orchestrator is "receiving" this information.

## Proposed Changes

### 1. Frontend: Enhanced Deliverables View (`Stage1Output.tsx`)
*   **Add "Orchestrator Handover" Section**:
    *   A visual block (card) that appears after the "Scaling Up" table.
    *   It will list the key data points extracted (e.g., "Buyer Persona Narrative", "Scaling Up Criteria").
    *   Status indicators (green checks) showing "Synced with Orchestrator".
*   **Add Navigation Footer**:
    *   Current location: Bottom of the view.
    *   **Buttons**:
        *   "← Return to Chat" (Secondary style) -> Switch `viewMode` back to 'chat'.
        *   "Continue to Stage 2 →" (Primary style) -> Navigate to `/stages/2`.

### 2. Frontend: Stage Transition Logic (`StageChat.tsx`)
*   **Pass Navigation Props**: Ensure `Stage1Output` receives functions to handle `onBackToChat` and `onNextStage`.
*   **Next Stage Availability**: Verify if Stage 2 is unlocked before enabling the "Continue" button.

### 3. Backend: Verify Data Handoff (`journey_agent.py`)
*   **Check**: The `get_initial_message` and `process_message` in `journey_agent.py` already consume `previous_stage_output`.
*   **Action**: No massive backend changes needed, but I will double-check that `previous_stage_output` correctly maps the fields generated by Stage 1 (`buyerPersona.narrative`, `scalingUpTable`).
*   **Refinement**: Update `journey_agent.py` to explicitly acknowledge the Stage 1 data in its welcoming message if it's not already doing so clearly.

## Verification Plan

### Manual Verification
1.  **Navigate to Completed Stage 1**:
    *   Verify the new "Orchestrator Handover" card appears.
    *   Verify the "Return to Chat" button switches the view.
    *   Verify the "Continue to Stage 2" button navigates to the next stage.
2.  **Start Stage 2**:
    *   Verify the initial message from Journey Agent references the data from Stage 1 (e.g., "I see we have a Buyer Persona for [Company]...").

### Browser Subagent
*   Use the browser subagent to click the new buttons and verify navigation and UI elements.
